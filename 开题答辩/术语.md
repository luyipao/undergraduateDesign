## Legendre polynomial basis

相邻的勒让德多项式有以下关系
$$
(n+1)p_{n+1} = (2n+1)xP_n - nP_{n-1}
$$
其中$P_0 = 1, P_1 = x$.

在单元$I_j=(x_{j-1/2},x_{j+1/2})$上，我们使用
$$
v_{0}^{(j)}(\xi)=1, \quad v_{1}^{(j)}(\xi)=\xi, \quad v_{2}^{(j)}(\xi)=\xi^{2}-\frac{1}{12}, \cdots
$$
其中 $\xi=\frac{x-x_{j}}{\Delta x_{j}}$。 除以 $\Delta x_j$保证数量级能够保持数量级的一致。

## TVD RK法

total variation diminishing (TVD) Runge-Kutta method 

离散情况下的total variation是
$$
TV(u^n) = TV(u(\cdot ,t^n)) = \sum_j |u^n_{j+1} - u^n_j|
$$
其中$u^n_j = u(x_j,t^n)$.

这个方法保证解的TV不增，也就是
$$
TV(u^{n+1}) \leq TV(u^n).
$$
TVD方法可以有效地控制数值解的震荡

对于时间步长也有要求，简单的形式为
$$
\Delta t \leq \text{CFL} \times \Delta t_1
$$


一般的RK法有如下格式
$$
u^{(i)} = \sum^{i-1}_{k=0}(a_{ik}u^{(k)} + \Delta t \beta_{ik}L(u^{(k)})),\quad i = 1,\ldots,m, \\
u^{(0)} = u^n, \quad u^{(m)} = u^{n+1}.
$$
显然如果所有系数非负$a_{ik} \geq 0, \beta_{ik} \geq 0$，那么上述格式就是Euler向前的凸组合，其中$\Delta t$被替换为$\frac{\beta_{ik}}{\alpha_{ik}} \Delta t$。

>  Clearly, if all the coefficients are nonnegative $a_{ik} \geq 0, \beta_{ik} \geq 0$ then (1.8) is just a
> convex combination of Euler forward operators, with $\Delta t$ replaced by $\frac{\beta_{ik}}{\alpha_{ik}} \Delta t$, since 
> by consistency $\sum^{i-1}_{k=0}\alpha_{ik} = 1$. 

RK法是TVD，在CFL条件下^[Efficient implementation of essentially non-oscillatory shock-
capturing schemes]，其中$CFL = \min \limits_{i,k}\frac{\beta_{ik}}{\alpha_{ik}} \Delta t $​ .

在文献Efficient implementation of essentially non-oscillatory shock-capturing schemes中CFL可以取1.

* 一阶TVD RK和向前欧拉以及1阶RK法

* 2阶TVD RK法也被称为2阶RK法，midpoint rule，modified Euler，Heun's method。

  欧拉法是Heun法的基础。即使步长非常小，欧拉法随着步骤的积累会导致偏离实际值。

* 3阶最优TVD RK法
$$
u^{(1)} & = u^n + \Delta t L(u^n), \\
  u^{(2)} & = \frac{1}{2}u^n + \frac{1}{4}u^{(1)} + \frac{1}{4}\Delta L(u^{(1)})), \\
  u^{n+1} & = \frac{1}{3}u^n + \frac{2}{3}u^{(2)} + \frac{2}{3}\Delta t L(u^{(2)}).
$$

CFL 系数c = 1.

 ## third order IMEX LDG scheme

IMEX的想法是其想法是隐性处理线性扩散部分，显性处理非线性耦合漂移项来节省计算成本，同
时依然追求无条件稳定性，即时间步长可以取小于给定常数的任意值。

论文中直接引用其他文章的结果Implicit-explicit Runge-Kutta methods for time-dependent partial differential
equations

## HF 高场模型



## DD 漂移扩散模型

$$
n_t - (\mu En)_x = \tau \theta n_{xx},  \\
			\phi_{xx} = \frac{e}{\epsilon}(n - n_d),
$$

convection term $- (\mu En)_x$

diffusion term $\tau \theta n_{xx}$

在相互作用，不满足叠加原理

The IMEX method uses implicit time discretization only for the
linear diffusion term and treat the nonlinear drift term coupled with the potential equation explicitly

We treat the nonlinear coupled
term explicitly and the diffusion term implicitly.

- 一阶导数项（对流项）：$- (\mu En)_x$，它描述的是电子在电场E下的漂移现象。在这里，\mu是电子的迁移率，E是电场，n是电子浓度。
- 二阶导数项（扩散项）：$\tau \theta n_{xx}$，它描述的是因为电子浓度的不均匀分布（或说是电子浓度的梯度），电子会从浓度较大的区域向浓度较小的区域自发扩散的现象。

DD模型可以和HF模型写成相似的结构

$n_t + J_x = 0$

$J = J_{hyp} + J_{vis}$

$J_{hyp} = -\mu n E$

$J_{vis} = -\tau(n\theta)_x$





定义$||u||_{L^{\infty}(0,T;L^2)}  = \max \limits_{0 \leq t \leq T}||u^m||_{l^2(I)}$和$||u||_{L^2(0,T;L^2)} = (\int_{0}^{T}||u^m||_{L^2(I)}^2\Delta t)^{\frac{1}{2}}$